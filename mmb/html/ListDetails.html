<!DOCTYPE html><html lang="zh-CN"><head>    <meta charset="utf-8">    <meta http-equiv="X-UA-Compatible" content="IE=edge">    <script>        document.querySelector('html').style.fontSize = window.screen.width/10 +'px';    </script>    <meta name="viewport" content="width=device-width, initial-scale=1">    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->    <title>列表展示</title>    <!-- Bootstrap -->    <link href="../lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">    <link rel="stylesheet" href="../css/ListDetails.css">    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->    <!--[if lt IE 9]>    <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>    <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>    <![endif]--></head><body><!--头部--><header class="base01">    <div class="left">        <a href="index.html">            <img src="../images/header_logo.png" alt=""></a>    </div>    <div class="right">        <a href="javascript:;">            <img src="../images/header_app.png" alt="">        </a>    </div></header><!--搜索框--><div class="shouye-search">    <input type="search" placeholder='请输入你相比价的商品'>    <a href="javascript:void(0)"><span>搜索</span></a></div><!--商品列表展示--><div class="container-fluid projects">    <!--导航条-->    <nav>        <ul class="nav nav-pills row">            <li class="col-xs-3" role="presentation"><a href="#" class="active">综合</a></li>            <li class="col-xs-3" role="presentation"><a href="#">销售</a></li>            <li class="col-xs-3" role="presentation"><a href="#">价格</a></li>            <li class="col-xs-3" role="presentation"><a href="#"><i class="glyphicon glyphicon-align-right"></i>筛选</a></li>        </ul>    </nav>    <!--商品展示-->    <div class="container-fluid list">        <!--<div class="media">-->            <!--<div class="media-left">-->                <!--<a href="#">-->                    <!--&lt;!&ndash;<img class="media-object" src="http://www.zuyushop.com:8013/ProPic/20174/small80/Thumb_2017040015060213966.jpg" alt="...">&ndash;&gt;-->                <!--</a>-->            <!--</div>-->            <!--<div class="media-body">-->                <!--<h4 class="media-heading">康佳(KONKA) LED32E11C 32英寸 高清普通电视</h4>-->                <!--<p class="price">￥1399</p>-->                <!--<p><span class="pull-left">2商城报价</span><span class="pull-right">有10人评论</span></p>-->            <!--</div>-->        <!--</div>-->    </div>    <!--分页按钮-->    <div class="btns container-fluid">        <button class="btn btn-default btn-sm" type="button" id="up">上一页</button>        <!-- Split button -->        <div class="btn-group">            <button id="showpage" type="button" class="btn btn-info btn-sm">1/3</button>            <button type="button" class="btn btn-info btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">                <span class="caret"></span>                <span class="sr-only">Toggle Dropdown</span>            </button>            <ul class="dropdown-menu">            </ul>        </div>        <button class="btn btn-default btn-sm" type="button" id="down">下一页</button>    </div></div><!--底部--><fooder>    <div class="container-fluid">        <div class="row">            <div class="col-xs-4">                <a href="javascript:;">登录</a>            </div>            <div class="col-xs-4">                <a href="javascript:;">注册</a>            </div>            <div class="col-xs-4">                <a href="ListDetails.html" style='text-decoration: none;'>                    <img src="../images/top.jpg" alt="">                    <p>返回顶部</p>                </a>            </div>        </div>    </div></fooder><div class ="base-food">    <p>        <a href="javascript:;">手机APP下载</a>        <a href="javascript:;">慢慢卖手机版</a>        "--掌上比价平台"    </p>    <p>m.manmanbuy.com</p></div><!--底部返回--><div class = "base-food-back">    <div class = "base-food-back-top">        <a href="javascript:;">            <img src="../images/TB2WepTeb1J.eBjSszcXXbFzVXa_!!379516416.png" alt="">        </a>    </div>    <div class = "base-food-back-bot">        <a href="#" class = "glyphicon glyphicon-circle-arrow-up">        </a>    </div></div><!-- jQuery (necessary for Bootstrap's JavaScript plugins) --><script src="../lib/bootstrap/js/jquery-1.12.4.min.js"></script><!-- Include all compiled plugins (below), or include individual files as needed --><script src="../lib/bootstrap/js/bootstrap.min.js"></script></body></html><script src='../lib/template/template-web.js'></script><script id="priceID" type="text/html">    {{each result}}    <div class="media">        <a class="goto" href="javascript:void(0)" data-productid={{$value.productId}}></a>        <div class="media-left">            <a href="#">                <!--<img class="media-object" src="http://www.zuyushop.com:8013/ProPic/20174/small80/Thumb_2017040015060213966.jpg" alt="...">-->                {{#$value.productImg}}            </a>        </div>        <div class="media-body">            <h4 class="media-heading">{{$value.productName}}</h4>            <p class="price">{{$value.productPrice}}</p>            <p><span class="pull-left">{{$value.productQuote}}</span><span class="pull-right">{{$value.productCom}}</span></p>        </div>    </div>    {{/each}}</script><script>     $(function () {         var pageid = 1;         var flag = true;         console.log(localStorage.categoryid);;         getData(localStorage.categoryid,pageid);         // 点击销售按钮         $('.row li:eq(1) a').click(function () {             $(this).addClass('active').parent().siblings().find('a').removeClass('active');         });         // 点击价格按钮         $('.row li:eq(2) a').click(function () {             if(flag){                 flag = false;             }             $(this).addClass('active').parent().siblings().find('a').removeClass('active');             console.log(123);             sort(pageid);         });         // 下一页按钮         $('#down').click(function () {             if($(this).html() == '末页'){                 alert('最后一页了');                 return;             }             pageid++;             if(flag){                 getData(localStorage.categoryid,pageid);             }else {                 sort(pageid);             }         });         // 上一页按钮         $('#up').click(function () {             if($(this).html() == '首页'){                 alert('第一页');                 return;             }             pageid--;             if(flag){                 getData(localStorage.categoryid,pageid);             }else {                 sort(pageid);             }         });         // 点击下拉菜单里面的选项到对应的页面         $('.dropdown-menu').on('click','.currentPage',function () {             var patt =/[\d+]/;             pageid  = patt.exec($(this).html());             console.log(pageid[0]);             getData(localStorage.categoryid,pageid[0]);         });         // 点击goto跳转到对应的商品展示页面         $('.list').on('click','.goto',function () {             localStorage.productId = $(this).attr('data-productid');             window.location.href='DetailsPage.html';         });     });     // 封装排序数据方法     function sort(pageid) {         /*          * 通过比较每个对象里面的价格          * 储存每个价格对象所对应的索引          *          * */         // 获取价格数据         $.ajax({             url:'http://139.199.192.48:9090/api/getproductlist',             data:{                 categoryid:localStorage.categoryid,                 pageid:pageid             },             success:function (data) {                 console.log(data);                 var picArr = [];                 for(var i=0;i<data.result.length;i++){                     // 添加数据                     picArr.push(data.result[i].productPrice.replace('￥',''));                 }                 console.log(picArr);                 // 循环遍历比较数组 并将下标索引赋值给indexNum                 var indexNum = [];                 var oldArr = [];                 for(var j=0;j<picArr.length;j++){                     oldArr[j]=picArr[j];                 }                 console.log(oldArr);                 // 新旧数组对比 获取下标索引                 picArr.sort(function (a,b) {                     return a-b;                 });                 picArr.forEach(function (val,index) {                     for(var k=0;k<oldArr.length;k++){                         if(val == oldArr[k]){                             indexNum.push(k);                         }                     }                 })                 console.log(indexNum);                 // 定义一个对象数组                 var obj = {                     result:[                     ]                 }                 for(var i=0;i<indexNum.length;i++){                     obj.result.push(data.result[indexNum[i]]);                 }                 console.log(obj);                 var result = template('priceID',obj);                 $('.list').html(result);                 // 设置上下页逻辑                 var $total = Math.ceil(data.totalCount/data.pagesize);                 $('#showpage').html(pageid+'/'+$total);                 if(pageid == $total){                     $('#down').html('末页');                 }else {                     $('#down').html('下一页');                 }                 if(pageid == 1){                     $('#up').html('首页');                 }else {                     $('#up').html('上一页');                 }                 // 动态生成页码                 var $li = '';                 for(var i=1;i<=$total;i++){                     $li+= '<li><a class="currentPage" href="#">'+i+'/'+$total+'</a></li>';                 }                 $('.dropdown-menu').html($li);             }         });     }     // 获取列表数据     function getData(categoryid,pageid) {         $.ajax({             url:'http://139.199.192.48:9090/api/getproductlist',             data:{                 categoryid:categoryid,                 pageid:pageid             },             success:function (data) {                 console.log(data);                 // 设置模板                 var result = template('priceID',data);                 $('.list').html(result);                 // 生成图片                 $('.list .media-left a').each(function (index,ele) {                     $(ele).html(data.result[index].productImg);                 });                 // 设置上下页逻辑                 var $total = Math.ceil(data.totalCount/data.pagesize);                 $('#showpage').html(pageid+'/'+$total);                 if(pageid == $total){                     $('#down').html('末页');                 }else {                     $('#down').html('下一页');                 }                 if(pageid == 1){                     $('#up').html('首页');                 }else {                     $('#up').html('上一页');                 }                 // 动态生成页码                 var $li = '';                 for(var i=1;i<=$total;i++){                     $li+= '<li><a class="currentPage" href="#">'+i+'/'+$total+'</a></li>';                 }                 $('.dropdown-menu').html($li);             }         });     }</script>